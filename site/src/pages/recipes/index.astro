---
import { getCollection } from "astro:content";

const items = await getCollection("recipes");
const sorted = items
  .slice()
  .sort((a, b) => {
    return a.data.title.localeCompare(b.data.title, "ru", { sensitivity: "base" });
  });

const snacks = sorted.filter((e) => e.data.category === "перекусы");
const desserts = sorted.filter((e) => e.data.category === "десерты");
const other = sorted.filter((e) => e.data.category !== "перекусы" && e.data.category !== "десерты");
---

<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Рецепты</title>
  </head>
  <body>
    <main style="min-height: 100vh; background: radial-gradient(1200px 600px at 20% -10%, #dbeafe 0%, rgba(219,234,254,0) 55%), radial-gradient(900px 520px at 90% 0%, #fce7f3 0%, rgba(252,231,243,0) 55%), #ffffff; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;">
      <div style="max-width: 980px; margin: 0 auto; padding: 28px 20px 36px;">
        <header style="display: flex; align-items: center; justify-content: space-between; gap: 12px; margin-bottom: 18px;">
          <div style="display: flex; align-items: center; gap: 10px;">
            <img src="/logo.png" alt="Dr.Welnes" width="34" height="34" style="display:block; width:34px; height:34px; border-radius: 10px; object-fit: cover;" />
            <div style="font-weight: 700; letter-spacing: -0.01em;">Dr.Welnes</div>
          </div>
          <nav style="display: flex; flex-wrap: wrap; gap: 10px;">
            <a href="/recipes" style="text-decoration: none; color: #111827; padding: 8px 10px; border-radius: 10px;">Рецепты</a>
            <a href="/exercises" style="text-decoration: none; color: #111827; padding: 8px 10px; border-radius: 10px;">Упражнения</a>
            <a href="/theory" style="text-decoration: none; color: #111827; padding: 8px 10px; border-radius: 10px;">Теория</a>
            <a href="/calculators" style="text-decoration: none; color: #111827; padding: 8px 10px; border-radius: 10px;">Калькуляторы</a>
          </nav>
        </header>

        <section style="border: 1px solid rgba(229,231,235,.9); background: rgba(255,255,255,.8); backdrop-filter: blur(10px); border-radius: 18px; padding: 22px; box-shadow: 0 10px 30px rgba(15,23,42,.08);">
          <h1 style="margin: 0 0 10px; font-size: 28px; line-height: 1.15; letter-spacing: -0.03em;">Рецепты</h1>
          <p style="margin: 0; color: #4b5563; font-size: 16px; line-height: 1.55; max-width: 64ch;">Подборка рецептов с описанием и видео. Открывай карточку — внутри пошаговая инструкция.</p>
        </section>

        <section style="margin-top: 16px;">
          <h2 style="margin: 0 0 10px; font-size: 18px;">Перекусы</h2>
          <div style="display: grid; gap: 12px;">
            {snacks.map((entry) => (
              <a
                href={`/recipes/${entry.slug}`}
                style="display: block; padding: 16px; border: 1px solid rgba(229,231,235,.9); border-radius: 16px; text-decoration: none; color: inherit; background: rgba(255,255,255,.8); box-shadow: 0 10px 30px rgba(15,23,42,.06);"
              >
                <div style="font-weight: 800; letter-spacing: -0.01em;">{entry.data.title}</div>
                {entry.data.description && (
                  <div style="margin-top: 6px; color: #4b5563;">{entry.data.description}</div>
                )}
              </a>
            ))}
          </div>

          <h2 style="margin: 18px 0 10px; font-size: 18px;">Десерты</h2>
          <div style="display: grid; gap: 12px;">
            {desserts.map((entry) => (
              <a
                href={`/recipes/${entry.slug}`}
                style="display: block; padding: 16px; border: 1px solid rgba(229,231,235,.9); border-radius: 16px; text-decoration: none; color: inherit; background: rgba(255,255,255,.8); box-shadow: 0 10px 30px rgba(15,23,42,.06);"
              >
                <div style="font-weight: 800; letter-spacing: -0.01em;">{entry.data.title}</div>
                {entry.data.description && (
                  <div style="margin-top: 6px; color: #4b5563;">{entry.data.description}</div>
                )}
              </a>
            ))}
          </div>

          {other.length > 0 && (
            <>
              <h2 style="margin: 18px 0 10px; font-size: 18px;">Остальное</h2>
              <div style="display: grid; gap: 12px;">
                {other.map((entry) => (
                  <a
                    href={`/recipes/${entry.slug}`}
                    style="display: block; padding: 16px; border: 1px solid rgba(229,231,235,.9); border-radius: 16px; text-decoration: none; color: inherit; background: rgba(255,255,255,.8); box-shadow: 0 10px 30px rgba(15,23,42,.06);"
                  >
                    <div style="font-weight: 800; letter-spacing: -0.01em;">{entry.data.title}</div>
                    {entry.data.description && (
                      <div style="margin-top: 6px; color: #4b5563;">{entry.data.description}</div>
                    )}
                  </a>
                ))}
              </div>
            </>
          )}
        </section>
      </div>
    </main>
  </body>
</html>
