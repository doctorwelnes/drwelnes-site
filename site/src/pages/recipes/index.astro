---
import { getCollection } from "astro:content";

const items = await getCollection("recipes");
const sorted = items
  .slice()
  .sort((a, b) => {
    const ad = a.data.publishedAt ? new Date(a.data.publishedAt).getTime() : 0;
    const bd = b.data.publishedAt ? new Date(b.data.publishedAt).getTime() : 0;
    return bd - ad;
  });
---

<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Рецепты</title>
  </head>
  <body>
    <main style="max-width: 900px; margin: 0 auto; padding: 24px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;">
      <nav style="margin-bottom: 16px;">
        <a href="/" style="text-decoration: none;">Главная</a>
      </nav>

      <h1 style="margin: 0 0 16px;">Рецепты</h1>

      <div style="display: grid; gap: 12px;">
        {sorted.map((entry) => (
          <a
            href={`/recipes/${entry.slug}`}
            style="display: block; padding: 14px 16px; border: 1px solid #e5e7eb; border-radius: 12px; text-decoration: none; color: inherit;"
          >
            <div style="font-weight: 600;">{entry.data.title}</div>
            {entry.data.description && (
              <div style="margin-top: 4px; color: #4b5563;">{entry.data.description}</div>
            )}
          </a>
        ))}
      </div>
    </main>
  </body>
</html>
