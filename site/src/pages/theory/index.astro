---
import { getCollection } from "astro:content";
import SiteLayout from "../../layouts/SiteLayout.astro";

const items = await getCollection("theory");
const sorted = items
  .slice()
  .sort((a, b) => {
    const ad = a.data.publishedAt ? new Date(a.data.publishedAt).getTime() : 0;
    const bd = b.data.publishedAt ? new Date(b.data.publishedAt).getTime() : 0;
    return bd - ad;
  });
---

<SiteLayout title="Теория">
  <section class="card card--hero" data-animate style="--delay: 0.05s;">
    <h1 class="hero-title">Теория</h1>
    <p class="hero-subtitle">Короткие статьи и основы: питание, тренировки, восстановление. Открывай материал для чтения.</p>
    <div class="chip-row" style="margin-top: 12px;">
      <span class="chip">Материалов <span class="chip-count">{sorted.length}</span></span>
      <span class="chip">Короткие статьи</span>
      <span class="chip">Можно читать с телефона</span>
    </div>
  </section>

  <section class="card card--soft" data-animate style="--delay: 0.1s;">
    <h2 class="section-title">Материалы</h2>
    <div class="card-grid">
      {sorted.map((entry) => (
        <a class="card card-link" href={`/theory/${entry.slug}`}>
          <div class="card-title">{entry.data.title}</div>
          {entry.data.description && <div class="card-text">{entry.data.description}</div>}
        </a>
      ))}
    </div>
  </section>
</SiteLayout>
